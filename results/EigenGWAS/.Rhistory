library(GAPIT)
setwd("/home/mie/Schreibtisch/Unistuff/Master/Semester2/Forschungsgruppenpraktikum_Steven/Git/rye_project")
myG <- read.table("data/hmp_TASSEL/mygenotypes.hmp.txt",
sep="\t",
comment.char = "",
header = FALSE)
alle_str <- toupper(gsub("\\s+", "", myG[,2]))
alle_str <- gsub("[|/]", "-", alle_str)
myG[-1,1] <- paste(myG[-1,1], alle_str[-1], sep="_")
myG[,3] <- sub("(?i)^(?:chr)?([1-7])r$", "\\1", myG[,3], perl = TRUE)
myG[,3] <- sub("(?i)^un$", "8", myG[,3], perl = TRUE)
myG[,3] <- sub("(?i)^b$", "9", myG[,3], perl = TRUE)
myY_raw <- read.table("data/pca_PLINK/maf.01_minDP20_maxDP100_minQ40_missing.10.splitted.eigenvec", head = FALSE)
keep <- c(1, 3:min(5, ncol(myY_raw)))
myY <- myY_raw[, keep, drop = FALSE]
colnames(myY) <- c("Taxa", paste0("PC", seq_len(ncol(myY)-1)))
Y  <- myY
setwd("/home/mie/Schreibtisch/Unistuff/Master/Semester2/Forschungsgruppenpraktikum_Steven/Git/rye_project/results/EigenGWAS")
geno <- GAPIT:::GAPIT.Genotype(G = myG, SNP.MAF = 0)
GD <- geno$GD
GM <- data.frame(
SNP        = as.character(geno$GI[[1]]),
Chromosome = as.numeric(geno$GI[[2]]),
Position   = as.numeric(geno$GI[[3]]),
stringsAsFactors = FALSE
)
con <- file(sprintf("gapit_%s.log", format(Sys.time(), "%Y%m%d")), open = "wt")   # "at" zum Anhängen
sink(con, split = TRUE)              # stdout -> Datei (split=TRUE zeigt es zusätzlich in der Konsole)
sink(con, type = "message")          # stderr (warnings/messages) -> Datei
on.exit({ sink(type="message"); sink(); close(con) }, add = TRUE)
myGAPIT <- GAPIT(
Y = Y,
GD = GD,
GM = GM,
PCA.total = 0,
model = "FarmCPU"
)
stopifnot(ncol(GD) == nrow(GM))
GD <- as.matrix(geno$GD)
storage.mode(GD) <- "numeric"
GM <- data.frame(
SNP        = as.character(geno$GI[[1]]),
Chromosome = as.numeric(geno$GI[[2]]),
Position   = as.numeric(geno$GI[[3]]),
stringsAsFactors = FALSE
)
con <- file(sprintf("gapit_%s.log", format(Sys.time(), "%Y%m%d")), open = "wt")   # "at" zum Anhängen
sink(con, split = TRUE)              # stdout -> Datei (split=TRUE zeigt es zusätzlich in der Konsole)
sink(con, type = "message")          # stderr (warnings/messages) -> Datei
on.exit({ sink(type="message"); sink(); close(con) }, add = TRUE)
myGAPIT <- GAPIT(
Y = Y,
GD = GD,
GM = GM,
PCA.total = 0,
model = "FarmCPU"
)
keep <- is.finite(GM$Chromosome) & is.finite(GM$Position) & !is.na(GM$SNP) & !duplicated(GM$SNP)
GM   <- GM[keep, , drop = FALSE]
GD   <- GD[, keep, drop = FALSE]
View(GD)
GD   <- GD[, keep, drop = FALSE]
stopifnot(ncol(GD) == nrow(GM))
con <- file(sprintf("gapit_%s.log", format(Sys.time(), "%Y%m%d")), open = "wt")   # "at" zum Anhängen
sink(con, split = TRUE)              # stdout -> Datei (split=TRUE zeigt es zusätzlich in der Konsole)
sink(con, type = "message")          # stderr (warnings/messages) -> Datei
on.exit({ sink(type="message"); sink(); close(con) }, add = TRUE)
myGAPIT <- GAPIT(
Y = Y,
GD = GD,
GM = GM,
PCA.total = 0,
model = "FarmCPU"
)
con <- file(sprintf("gapit_%s.log", format(Sys.time(), "%Y%m%d")), open = "wt")   # "at" zum Anhängen
sink(con, split = TRUE)              # stdout -> Datei (split=TRUE zeigt es zusätzlich in der Konsole)
sink(con, type = "message")          # stderr (warnings/messages) -> Datei
on.exit({ sink(type="message"); sink(); close(con) }, add = TRUE)
myGAPIT <- GAPIT(
Y = Y,
GD = GD,
GM = GM,
PCA.total = 0,
model = "FarmCPU"
)
c(n_taxa = nrow(GD), n_markers_GD = ncol(GD), n_markers_GM = nrow(GM))
c(nrowY = nrow(Y), nTaxaGD = nrow(GD), nMrkGD = ncol(GD), nMrkGM = nrow(GM))
anyDuplicated(GM$SNP)
all(colnames(GD) == GM$SNP)
sum(!(rownames(GD) %in% Y$Taxa))
colnames(GD) <- GM$SNP
View(GD)
all(colnames(GD) == GM$SNP)
myGAPIT <- GAPIT(
Y = Y,
SNP.MAF = 0,
GD = GD,
GM = GM,
PCA.total = 0,
model = "FarmCPU"
)
c(nrowY = nrow(Y), nTaxaGD = nrow(GD), nMrkGD = ncol(GD), nMrkGM = nrow(GM))
anyDuplicated(GM$SNP)
all(colnames(GD) == GM$SNP)
sum(!(rownames(GD) %in% Y$Taxa))
