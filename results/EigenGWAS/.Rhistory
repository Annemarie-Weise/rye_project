MAF <- 0.02
method <- "componentwise"
K <- 3
free_deg <- 1
result <- pcadapt(pcadapt_data, K = K, min.maf = MAF , method = method)
# QQ-Plots
log10p_PC1 <- pchisq(result$chi2.stat[,1], df = free_deg, lower.tail = FALSE, log.p = TRUE) / log(10)
log10p_PC2 <- pchisq(result$chi2.stat[,2], df = free_deg, lower.tail = FALSE, log.p = TRUE) / log(10)
log10p_PC3 <- pchisq(result$chi2.stat[,3], df = free_deg, lower.tail = FALSE, log.p = TRUE) / log(10)
p1 <- qq_log10p(log10p_PC1, title = bquote(atop(bold("(a)") ~ " PC1, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 2000))
p2 <- qq_log10p(log10p_PC2, title = bquote(atop(bold("(b)") ~ " PC2, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 3000))
p3 <- qq_log10p(log10p_PC3, title = bquote(atop(bold("(c)") ~ " PC3, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 80))
pg <- plot_grid(
p1, p2,
p3, NULL,
ncol = 2, nrow = 2, align = "hv"
)
pdf(paste0("results/pcadapt/maf_", MAF, "/", method, "/qqs_", MAF, "_", method, "_pcadapt.pdf"),
width = 9.6, height = 9.6)
print(pg)
dev.off()
p1 <- qq_log10p(log10p_PC1, title = bquote(atop(bold("(a)") ~ " PC1, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 300))
p2 <- qq_log10p(log10p_PC2, title = bquote(atop(bold("(b)") ~ " PC2, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 100))
p3 <- qq_log10p(log10p_PC3, title = bquote(atop(bold("(c)") ~ " PC3, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 50))
pg <- plot_grid(
p1, p2,
p3, NULL,
ncol = 2, nrow = 2, align = "hv"
)
pdf(paste0("results/pcadapt/maf_", MAF, "/", method, "/qqs_", MAF, "_", method, "_pcadapt.pdf"),
width = 9.6, height = 9.6)
print(pg)
dev.off()
p1 <- qq_log10p(log10p_PC1, title = bquote(atop(bold("(a)") ~ " PC1, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 200))
p2 <- qq_log10p(log10p_PC2, title = bquote(atop(bold("(b)") ~ " PC2, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 25))
p3 <- qq_log10p(log10p_PC3, title = bquote(atop(bold("(c)") ~ " PC3, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 45))
pg <- plot_grid(
p1, p2,
p3, NULL,
ncol = 2, nrow = 2, align = "hv"
)
pdf(paste0("results/pcadapt/maf_", MAF, "/", method, "/qqs_", MAF, "_", method, "_pcadapt.pdf"),
width = 9.6, height = 9.6)
print(pg)
dev.off()
pdf(paste0("results/pcadapt/maf_",MAF,"/",method,"/histograms_",MAF,"_",method,"_pcadapt.pdf"),
width = 9.6, height = 9.6)
op <- par(mfrow = c(2, 2), mar = c(4, 4, 2, 1))
on.exit(par(op), add = TRUE)
for (k in 1:3) {
x <- result$pvalues[, k]
x <- x[is.finite(x)]
hist(x, xlab = "p-values", breaks = 50, col = "#FF7F00", main = "")
lab <- paste0("(", letters[k], ")")
title(
main = bquote(
bold(.(lab)) ~ " PC" * .(k) * "," ~ " MAF = " ~ .(MAF) * ", Method = " ~ .(method)),
adj = 0,      # linksbündig
cex.main = 0.9
)
}
plot.new()
dev.off()
# Manhatten-Plot - 3 PCs
limit <- c(2000,2500,80)
for (pc in seq_len(K)) {
p <- manhattan_pcadapt(result, free_deg = free_deg, limits = c(0, limit[pc]), PC = pc,
title = paste0("PC", pc, ", MAF = ", MAF, ", Method = ", method)
)
write.csv(p$df, row.names = FALSE,
paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_results_", MAF, "_", method, "_pcadapt.csv"))
pdf(paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_manhatten_", MAF, "_", method, "_pcadapt.pdf"),
width = 11.69, height = 8.27)
print(p$plot)
dev.off()
}
# Manhatten-Plot - 3 PCs
limit <- c(250,100,30)
for (pc in seq_len(K)) {
p <- manhattan_pcadapt(result, free_deg = free_deg, limits = c(0, limit[pc]), PC = pc,
title = paste0("PC", pc, ", MAF = ", MAF, ", Method = ", method)
)
write.csv(p$df, row.names = FALSE,
paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_results_", MAF, "_", method, "_pcadapt.csv"))
pdf(paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_manhatten_", MAF, "_", method, "_pcadapt.pdf"),
width = 11.69, height = 8.27)
print(p$plot)
dev.off()
}
limit <- c(200,25,30)
for (pc in seq_len(K)) {
p <- manhattan_pcadapt(result, free_deg = free_deg, limits = c(0, limit[pc]), PC = pc,
title = paste0("PC", pc, ", MAF = ", MAF, ", Method = ", method)
)
write.csv(p$df, row.names = FALSE,
paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_results_", MAF, "_", method, "_pcadapt.csv"))
pdf(paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_manhatten_", MAF, "_", method, "_pcadapt.pdf"),
width = 11.69, height = 8.27)
print(p$plot)
dev.off()
}
# ------------------ Mahalanobis -----------------------
MAF <- 0.03
method <- "mahalanobis"
# Screeplot - 20 PCs
K <- 20
result <- pcadapt(pcadapt_data, K = K, min.maf = MAF ,method = method)
p <- pcadapt_screeplot(result, maf = MAF, method = method)
pdf(paste0("results/pcadapt/maf_",MAF,"/",method,"/screeplot_",MAF,"_",method,"_pcadapt.pdf"),
width = 6, height = 4)
print(p)
dev.off()
# PCA-Plot - 3 PCs
K <- 3
result <- pcadapt(pcadapt_data, K = K, min.maf = MAF ,method = method )
p <- pcadapt_pc_scatter(result, maf = MAF, method = method)
pdf(paste0("results/pcadapt/maf_",MAF,"/",method,"/pca_",MAF,"_",method,"_pcadapt.pdf"),
width = 9.27, height = 4.8)
print(p)
dev.off()
# QQ-Plot - 3 PCs
log10p <- pchisq(result$chi2.stat, df = K, lower.tail = FALSE, log.p = TRUE) / log(10)
p <- qq_log10p(log10p, title = paste0("MAF = ", MAF, ", Method = ", method),
limits = c(0, 300))
pdf(paste0("results/pcadapt/maf_",MAF,"/",method,"/qq_",MAF,"_",method,"_pcadapt.pdf"),
width = 4.8, height = 4.8)
print(p)
dev.off()
# QQ-Plot - 3 PCs
log10p <- pchisq(result$chi2.stat, df = K, lower.tail = FALSE, log.p = TRUE) / log(10)
p <- qq_log10p(log10p, title = paste0("MAF = ", MAF, ", Method = ", method),
limits = c(0, 500))
pdf(paste0("results/pcadapt/maf_",MAF,"/",method,"/qq_",MAF,"_",method,"_pcadapt.pdf"),
width = 4.8, height = 4.8)
print(p)
dev.off()
# QQ-Plot - 3 PCs
log10p <- pchisq(result$chi2.stat, df = K, lower.tail = FALSE, log.p = TRUE) / log(10)
p <- qq_log10p(log10p, title = paste0("MAF = ", MAF, ", Method = ", method),
limits = c(0, 400))
pdf(paste0("results/pcadapt/maf_",MAF,"/",method,"/qq_",MAF,"_",method,"_pcadapt.pdf"),
width = 4.8, height = 4.8)
print(p)
dev.off()
pdf(paste0("results/pcadapt/maf_",MAF,"/",method,"/histogram_",MAF,"_",method,"_pcadapt.pdf"),
width = 4.8, height = 4.8)
hist(result$pvalues, xlab = "p-values", breaks = 50, col = "#FF7F00", main = "")
title(main = paste0("MAF = ", MAF, ", Method = ", method), font.main = 1,
cex.main  = 0.9, adj = 0)
dev.off()
# Loading - LD-Thinning? - 3 PCs
pdf(paste0("results/pcadapt/maf_", MAF, "/", method, "/LD-Thinning_", MAF, "_", method, "_pcadapt.pdf"),
width = 8, height = 6)
op <- par(mfrow = c(2, 2), mar   = c(4, 4, 1, 1), oma   = c(1, 1, 3, 1))
on.exit(par(op), add = TRUE)
for (i in 1:3) {
plot(result$loadings[, i],
pch = 19, cex = .3,
ylab = paste0("Loadings PC", i), xlab = "")
}
mtext(paste0("   MAF = ", MAF, ", Method = ", method),
side = 3, outer = TRUE, line = 1, adj = 0, font = 1, cex  = 1.0)
dev.off()
# Loadings-Violin - 3 PCs
p <- loadings_violin_pcadapt(result, title = paste0("MAF = ", MAF, ", Method = ", method))
pdf(paste0("results/pcadapt/maf_",MAF,"/",method,"/loadings_violins_",MAF,"_",method,"_pcadapt.pdf"),
width = 9.27, height = 5)
print(p)
dev.off()
# Manhatten-Plot - 3 PCs
p <- manhattan_pcadapt(result, K = K,
title = paste0("MAF = ", MAF, ", Method = ", method),
limits = c(0, 300))
free_deg <- K
# Manhatten-Plot - 3 PCs
p <- manhattan_pcadapt(result, free_deg = free_deg,
title = paste0("MAF = ", MAF, ", Method = ", method),
limits = c(0, 300))
write.csv(p$df, row.names = FALSE,
paste0("results/pcadapt/maf_",MAF,"/",method,"/results_",MAF,"_",method,"_pcadapt.csv"))
pdf(paste0("results/pcadapt/maf_",MAF,"/",method,"/manhatten_",MAF,"_",method,"_pcadapt.pdf"),
width = 11.69, height = 8.27)
print(p$plot)
dev.off()
# Manhatten-Plot - 3 PCs
p <- manhattan_pcadapt(result, free_deg = free_deg,
title = paste0("MAF = ", MAF, ", Method = ", method),
limits = c(0, 400))
write.csv(p$df, row.names = FALSE,
paste0("results/pcadapt/maf_",MAF,"/",method,"/results_",MAF,"_",method,"_pcadapt.csv"))
pdf(paste0("results/pcadapt/maf_",MAF,"/",method,"/manhatten_",MAF,"_",method,"_pcadapt.pdf"),
width = 11.69, height = 8.27)
print(p$plot)
dev.off()
# ------------------ Componentwise -----------------------
MAF <- 0.03
method <- "componentwise"
K <- 3
free_deg <- 1
result <- pcadapt(pcadapt_data, K = K, min.maf = MAF , method = method)
# QQ-Plots
log10p_PC1 <- pchisq(result$chi2.stat[,1], df = free_deg, lower.tail = FALSE, log.p = TRUE) / log(10)
log10p_PC2 <- pchisq(result$chi2.stat[,2], df = free_deg, lower.tail = FALSE, log.p = TRUE) / log(10)
log10p_PC3 <- pchisq(result$chi2.stat[,3], df = free_deg, lower.tail = FALSE, log.p = TRUE) / log(10)
p1 <- qq_log10p(log10p_PC1, title = bquote(atop(bold("(a)") ~ " PC1, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 200))
p2 <- qq_log10p(log10p_PC2, title = bquote(atop(bold("(b)") ~ " PC2, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 25))
p3 <- qq_log10p(log10p_PC3, title = bquote(atop(bold("(c)") ~ " PC3, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 45))
pg <- plot_grid(
p1, p2,
p3, NULL,
ncol = 2, nrow = 2, align = "hv"
)
pdf(paste0("results/pcadapt/maf_", MAF, "/", method, "/qqs_", MAF, "_", method, "_pcadapt.pdf"),
width = 9.6, height = 9.6)
print(pg)
dev.off()
p1 <- qq_log10p(log10p_PC1, title = bquote(atop(bold("(a)") ~ " PC1, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 400))
p2 <- qq_log10p(log10p_PC2, title = bquote(atop(bold("(b)") ~ " PC2, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 200))
p3 <- qq_log10p(log10p_PC3, title = bquote(atop(bold("(c)") ~ " PC3, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 200))
pg <- plot_grid(
p1, p2,
p3, NULL,
ncol = 2, nrow = 2, align = "hv"
)
pdf(paste0("results/pcadapt/maf_", MAF, "/", method, "/qqs_", MAF, "_", method, "_pcadapt.pdf"),
width = 9.6, height = 9.6)
print(pg)
dev.off()
p1 <- qq_log10p(log10p_PC1, title = bquote(atop(bold("(a)") ~ " PC1, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 400))
p2 <- qq_log10p(log10p_PC2, title = bquote(atop(bold("(b)") ~ " PC2, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 80))
p3 <- qq_log10p(log10p_PC3, title = bquote(atop(bold("(c)") ~ " PC3, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 150))
pg <- plot_grid(
p1, p2,
p3, NULL,
ncol = 2, nrow = 2, align = "hv"
)
pdf(paste0("results/pcadapt/maf_", MAF, "/", method, "/qqs_", MAF, "_", method, "_pcadapt.pdf"),
width = 9.6, height = 9.6)
print(pg)
dev.off()
p1 <- qq_log10p(log10p_PC1, title = bquote(atop(bold("(a)") ~ " PC1, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 400))
p2 <- qq_log10p(log10p_PC2, title = bquote(atop(bold("(b)") ~ " PC2, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 70))
p3 <- qq_log10p(log10p_PC3, title = bquote(atop(bold("(c)") ~ " PC3, MAF = " ~ .(MAF) ~ ",",
"                  Method = " ~ .(method))),
limits = c(0, 150))
pg <- plot_grid(
p1, p2,
p3, NULL,
ncol = 2, nrow = 2, align = "hv"
)
pdf(paste0("results/pcadapt/maf_", MAF, "/", method, "/qqs_", MAF, "_", method, "_pcadapt.pdf"),
width = 9.6, height = 9.6)
print(pg)
dev.off()
# Histogramme
pdf(paste0("results/pcadapt/maf_",MAF,"/",method,"/histograms_",MAF,"_",method,"_pcadapt.pdf"),
width = 9.6, height = 9.6)
op <- par(mfrow = c(2, 2), mar = c(4, 4, 2, 1))
on.exit(par(op), add = TRUE)
for (k in 1:3) {
x <- result$pvalues[, k]
x <- x[is.finite(x)]
hist(x, xlab = "p-values", breaks = 50, col = "#FF7F00", main = "")
lab <- paste0("(", letters[k], ")")
title(
main = bquote(
bold(.(lab)) ~ " PC" * .(k) * "," ~ " MAF = " ~ .(MAF) * ", Method = " ~ .(method)),
adj = 0,      # linksbündig
cex.main = 0.9
)
}
plot.new()
dev.off()
# Manhatten-Plot - 3 PCs
limit <- c(200,25,30)
# Manhatten-Plot - 3 PCs
limit <- c(1000,1000,1000)
for (pc in seq_len(K)) {
p <- manhattan_pcadapt(result, free_deg = free_deg, limits = c(0, limit[pc]), PC = pc,
title = paste0("PC", pc, ", MAF = ", MAF, ", Method = ", method)
)
write.csv(p$df, row.names = FALSE,
paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_results_", MAF, "_", method, "_pcadapt.csv"))
pdf(paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_manhatten_", MAF, "_", method, "_pcadapt.pdf"),
width = 11.69, height = 8.27)
print(p$plot)
dev.off()
}
limit <- c(400,100,200)
for (pc in seq_len(K)) {
p <- manhattan_pcadapt(result, free_deg = free_deg, limits = c(0, limit[pc]), PC = pc,
title = paste0("PC", pc, ", MAF = ", MAF, ", Method = ", method)
)
write.csv(p$df, row.names = FALSE,
paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_results_", MAF, "_", method, "_pcadapt.csv"))
pdf(paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_manhatten_", MAF, "_", method, "_pcadapt.pdf"),
width = 11.69, height = 8.27)
print(p$plot)
dev.off()
}
limit <- c(400,110,150)
for (pc in seq_len(K)) {
p <- manhattan_pcadapt(result, free_deg = free_deg, limits = c(0, limit[pc]), PC = pc,
title = paste0("PC", pc, ", MAF = ", MAF, ", Method = ", method)
)
write.csv(p$df, row.names = FALSE,
paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_results_", MAF, "_", method, "_pcadapt.csv"))
pdf(paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_manhatten_", MAF, "_", method, "_pcadapt.pdf"),
width = 11.69, height = 8.27)
print(p$plot)
dev.off()
}
limit <- c(400,150,150)
for (pc in seq_len(K)) {
p <- manhattan_pcadapt(result, free_deg = free_deg, limits = c(0, limit[pc]), PC = pc,
title = paste0("PC", pc, ", MAF = ", MAF, ", Method = ", method)
)
write.csv(p$df, row.names = FALSE,
paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_results_", MAF, "_", method, "_pcadapt.csv"))
pdf(paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_manhatten_", MAF, "_", method, "_pcadapt.pdf"),
width = 11.69, height = 8.27)
print(p$plot)
dev.off()
}
# Manhatten-Plot - 3 PCs
limit <- c(400,75,150)
for (pc in seq_len(K)) {
p <- manhattan_pcadapt(result, free_deg = free_deg, limits = c(0, limit[pc]), PC = pc,
title = paste0("PC", pc, ", MAF = ", MAF, ", Method = ", method)
)
write.csv(p$df, row.names = FALSE,
paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_results_", MAF, "_", method, "_pcadapt.csv"))
pdf(paste0("results/pcadapt/maf_", MAF, "/", method,
"/PC", pc, "_manhatten_", MAF, "_", method, "_pcadapt.pdf"),
width = 11.69, height = 8.27)
print(p$plot)
dev.off()
}
library(GAPIT)
setwd("/home/mie/Schreibtisch/Unistuff/Master/Semester2/Forschungsgruppenpraktikum_Steven/Git/rye_project")
myG <- read.table("data/hmp_TASSEL/mygenotypes.hmp.txt",
sep="\t",
comment.char = "",
header = FALSE)  # HapMap hat header=FALSE
View(myG)
myG <- read.table("data/hmp_TASSEL/mygenotypes.hmp.txt",
sep="\t",
comment.char = "",
header = TRUE)
myG[,3] <- sub("(?i)^(?:chr)?([1-7])r$", "\\1", myG[,3], perl = TRUE)
View(myG)
myG[,3] <- sub("(?i)^un$", "8", myG[,3], perl = TRUE)
View(myG)
myG[,3] <- sub("(?i)^b$", "9", myG[,3], perl = TRUE)
myY_raw <- read.table("data/pca_PLINK/maf.01_minDP20_maxDP100_minQ40_missing.10.splitted.eigenvec", head = FALSE)
keep <- c(1, 3:min(5, ncol(myY_raw)))
myY <- myY_raw[, keep, drop = FALSE]
colnames(myY) <- c("Taxa", paste0("PC", seq_len(ncol(myY)-1)))
# PC2+PC3 als Kovariaten?
Y  <- myY #[, c("Taxa","PC2")]
CV <- myY[, c("Taxa","PC2","PC3")]
setwd("/home/mie/Schreibtisch/Unistuff/Master/Semester2/Forschungsgruppenpraktikum_Steven/Git/rye_project/results/EigenGWAS")
myGAPIT <- GAPIT(
Y=Y,
G=myG,
PCA.total=0,
model="FarmCPU"
)
setwd("/home/mie/Schreibtisch/Unistuff/Master/Semester2/Forschungsgruppenpraktikum_Steven/Git/rye_project/results/EigenGWAS")
log_file <- sprintf("gapit_%s.log", format(Sys.time(), "%Y%m%d-%H%M%S"))
con <- file(log_file, open = "wt")   # "at" zum Anhängen
sink(con, split = TRUE)              # stdout -> Datei (split=TRUE zeigt es zusätzlich in der Konsole)
sink(con, type = "message")          # stderr (warnings/messages) -> Datei
on.exit({ sink(type="message"); sink(); close(con) }, add = TRUE)
myGAPIT <- GAPIT(
Y = Y,
G = myG,
PCA.total = 0,
model = "FarmCPU"
)
myY$Taxa <- paste0("X",myY$Taxa)
setwd("/home/mie/Schreibtisch/Unistuff/Master/Semester2/Forschungsgruppenpraktikum_Steven/Git/rye_project/results/EigenGWAS")
con <- file(sprintf("gapit_%s.log", format(Sys.time(), "%Y%m%d-%H%M%S")), open = "wt")   # "at" zum Anhängen
sink(con, split = TRUE)              # stdout -> Datei (split=TRUE zeigt es zusätzlich in der Konsole)
sink(con, type = "message")          # stderr (warnings/messages) -> Datei
on.exit({ sink(type="message"); sink(); close(con) }, add = TRUE)
myGAPIT <- GAPIT(
Y = Y,
G = myG,
PCA.total = 0,
model = "FarmCPU"
)
setwd("/home/mie/Schreibtisch/Unistuff/Master/Semester2/Forschungsgruppenpraktikum_Steven/Git/rye_project")
myG <- read.table("data/hmp_TASSEL/mygenotypes.hmp.txt",
sep="\t",
comment.char = "",
header = FALSE)
myG[,3] <- sub("(?i)^(?:chr)?([1-7])r$", "\\1", myG[,3], perl = TRUE)
myG[,3] <- sub("(?i)^un$", "8", myG[,3], perl = TRUE)
myG[,3] <- sub("(?i)^b$", "9", myG[,3], perl = TRUE)
myY_raw <- read.table("data/pca_PLINK/maf.01_minDP20_maxDP100_minQ40_missing.10.splitted.eigenvec", head = FALSE)
keep <- c(1, 3:min(5, ncol(myY_raw)))
myY <- myY_raw[, keep, drop = FALSE]
colnames(myY) <- c("Taxa", paste0("PC", seq_len(ncol(myY)-1)))
myY$Taxa <- paste0("X",myY$Taxa)
Y  <- myY #[, c("Taxa","PC2")]
setwd("/home/mie/Schreibtisch/Unistuff/Master/Semester2/Forschungsgruppenpraktikum_Steven/Git/rye_project/results/EigenGWAS")
con <- file(sprintf("gapit_%s.log", format(Sys.time(), "%Y%m%d-%H%M%S")), open = "wt")   # "at" zum Anhängen
sink(con, split = TRUE)              # stdout -> Datei (split=TRUE zeigt es zusätzlich in der Konsole)
sink(con, type = "message")          # stderr (warnings/messages) -> Datei
on.exit({ sink(type="message"); sink(); close(con) }, add = TRUE)
myGAPIT <- GAPIT(
Y = Y,
G = myG,
PCA.total = 0,
model = "FarmCPU"
)
library(GAPIT)
setwd("/home/mie/Schreibtisch/Unistuff/Master/Semester2/Forschungsgruppenpraktikum_Steven/Git/rye_project")
myG <- read.table("data/hmp_TASSEL/mygenotypes.hmp.txt",
sep="\t",
comment.char = "",
header = FALSE)
myG[,3] <- sub("(?i)^(?:chr)?([1-7])r$", "\\1", myG[,3], perl = TRUE)
myG[,3] <- sub("(?i)^un$", "8", myG[,3], perl = TRUE)
myG[,3] <- sub("(?i)^b$", "9", myG[,3], perl = TRUE)
myY_raw <- read.table("data/pca_PLINK/maf.01_minDP20_maxDP100_minQ40_missing.10.splitted.eigenvec", head = FALSE)
keep <- c(1, 3:min(5, ncol(myY_raw)))
myY <- myY_raw[, keep, drop = FALSE]
colnames(myY) <- c("Taxa", paste0("PC", seq_len(ncol(myY)-1)))
Y  <- myY
setwd("/home/mie/Schreibtisch/Unistuff/Master/Semester2/Forschungsgruppenpraktikum_Steven/Git/rye_project/results/EigenGWAS")
con <- file(sprintf("gapit_%s.log", format(Sys.time(), "%Y%m%d")), open = "wt")   # "at" zum Anhängen
sink(con, split = TRUE)              # stdout -> Datei (split=TRUE zeigt es zusätzlich in der Konsole)
sink(con, type = "message")          # stderr (warnings/messages) -> Datei
on.exit({ sink(type="message"); sink(); close(con) }, add = TRUE)
myGAPIT <- GAPIT(
Y = Y,
G = myG,
PCA.total = 0,
model = "FarmCPU"
)
gc()
View(myG)
geno <- GAPIT.Genotype(G = myG, SNP.MAF = 0)
dim(geno$GD); dim(geno$GM)
gc()
geno <- GAPIT.Genotype(G = myG, SNP.MAF = 0)
alle_str <- toupper(gsub("\\s+", "", myG[,2]))
alle_str <- gsub("[|/]", "-", alle_str)
myG[["rs#"]] <- paste(myG$chrom, myG$pos, alle_str, sep="_")
myG[-1,1] <- paste(myG$chrom, myG$pos, alle_str, sep="_")
myG[-1,1] <- paste(myG[-1,1], alle_str, sep="_")
myG[-1,1] <- paste(myG[,1], alle_str, sep="_")
gc()
gc()
gc()
